<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Zcash Explorer - Block <%= block.height || block.hash %></title>
  <link rel="stylesheet" href="/styles.css" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    referrerpolicy="no-referrer"
  />
  <script src="/app.js" defer></script>
</head>
<body class="theme-zec">
  <header class="topbar">
    <a href="/" class="brand brand-link">
      <div class="brand-logo">Z</div>
      <div class="brand-text">
        <span class="brand-title">Zcash Explorer</span>
        <span class="brand-subtitle">Block <%= block.height || block.hash %></span>
      </div>
    </a>
    <nav class="nav-tabs">
      <a href="/" class="nav-tab <%= activeTab === 'home' ? 'nav-tab-active' : '' %>">Overview</a>
      <a href="/blocks" class="nav-tab <%= activeTab === 'blocks' ? 'nav-tab-active' : '' %>">Blocks</a>
      <a href="/txs" class="nav-tab <%= activeTab === 'txs' ? 'nav-tab-active' : '' %>">Transactions</a>
    </nav>
    <div class="topbar-actions">
      <form method="POST" action="/search" class="search-form">
        <input
          class="search-input"
          type="text"
          name="query"
          placeholder="Search by block height, block hash, or transaction ID"
          required
        />
        <button type="submit" class="button-primary">
          <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
          <span>Search</span>
        </button>
      </form>
      <a href="/" class="back-link">&larr; Back to home</a>
      <button type="button" class="theme-toggle" data-theme-toggle>
        <i class="fa-solid fa-moon theme-toggle-icon" aria-hidden="true"></i>
      </button>
    </div>
  </header>

  <main class="container wide-layout">
    <section class="grid-2">
      <!-- Primary block details -->
      <div class="card block-main-card">
        <div class="page-header">
          <h1 class="page-title">Block #<%= summary.height %></h1>
          <div class="chip">
            <span class="badge-dot"></span>
            <span class="chip-label">Height <%= summary.height %></span>
          </div>
        </div>

        <div class="detail-list">
          <div class="detail-item">
            <div class="key-label">Hash</div>
            <div class="key-value kv-mono">
              <span class="hash-with-copy">
                <span class="hash-truncate" title="<%= summary.hash %>"><%= summary.hash %></span>
              </span>
            </div>
          </div>

          <div class="detail-item">
            <div class="key-label">Mined on</div>
            <div class="key-value">
              <span><%= summary.minedOn %></span>
              <span class="muted"> (<%= summary.minedAgo %>)</span>
            </div>
          </div>

          <div class="detail-item">
            <div class="key-label">Miner</div>
            <div class="key-value kv-mono"><%= summary.miner || 'Unknown' %></div>
          </div>

          <div class="detail-item">
            <div class="key-label">Input count</div>
            <div class="key-value"><%= summary.inputCount %></div>
          </div>

          <div class="detail-item">
            <div class="key-label">Output count</div>
            <div class="key-value"><%= summary.outputCount %></div>
          </div>

          <div class="detail-item">
            <div class="key-label">Input total</div>
            <div class="key-value"><%= summary.inputTotal.toFixed(8) %> ZEC</div>
          </div>

          <div class="detail-item">
            <div class="key-label">Output total</div>
            <div class="key-value"><%= summary.outputTotal.toFixed(8) %> ZEC</div>
          </div>

          <div class="detail-item">
            <div class="key-label">Previous block</div>
            <div class="key-value kv-mono">
              <% if (block.previousblockhash) { %>
                <a href="/block/<%= block.previousblockhash %>" class="hash-with-copy">
                  <span class="hash-truncate" title="<%= block.previousblockhash %>"><%= block.previousblockhash %></span>
                </a>
              <% } else { %>
                <span class="muted">N/A</span>
              <% } %>
            </div>
          </div>

          <div class="detail-item">
            <div class="key-label">Next block</div>
            <div class="key-value kv-mono">
              <% if (block.nextblockhash) { %>
                <a href="/block/<%= block.nextblockhash %>" class="hash-with-copy">
                  <span class="hash-truncate" title="<%= block.nextblockhash %>"><%= block.nextblockhash %></span>
                </a>
              <% } else { %>
                <span class="muted">Tip</span>
              <% } %>
            </div>
          </div>
        </div>
      </div>

      <!-- Technical details -->
      <div class="card block-tech-card">
        <div class="card-header">
          <div class="section-title">Technical Details</div>
        </div>
        <div class="detail-list">
          <div class="detail-item">
            <div class="key-label">Difficulty</div>
            <div class="key-value"><%= typeof block.difficulty === 'number' ? block.difficulty : (block.difficulty || '–') %></div>
          </div>

          <div class="detail-item">
            <div class="key-label">Size</div>
            <div class="key-value"><%= (block.size || block.strippedsize || 0).toLocaleString() %> bytes</div>
          </div>

          <div class="detail-item">
            <div class="key-label">Version</div>
            <div class="key-value"><%= block.version != null ? block.version : '–' %></div>
          </div>

          <div class="detail-item">
            <div class="key-label">Confirmations</div>
            <div class="key-value"><%= block.confirmations != null ? block.confirmations : '–' %></div>
          </div>

          <div class="detail-item">
            <div class="key-label">Bits</div>
            <div class="key-value kv-mono"><%= block.bits || '–' %></div>
          </div>

          <div class="detail-item">
            <div class="key-label">Merkle root</div>
            <div class="key-value kv-mono">
              <% if (block.merkleroot) { %>
                <span class="hash-truncate" title="<%= block.merkleroot %>"><%= block.merkleroot %></span>
              <% } else { %>
                <span class="muted">–</span>
              <% } %>
            </div>
          </div>

          <div class="detail-item">
            <div class="key-label">Chainwork</div>
            <div class="key-value kv-mono">
              <% if (block.chainwork) { %>
                <span class="hash-truncate" title="<%= block.chainwork %>"><%= block.chainwork %></span>
              <% } else { %>
                <span class="muted">–</span>
              <% } %>
            </div>
          </div>

          <div class="detail-item">
            <div class="key-label">Nonce</div>
            <div class="key-value kv-mono"><%= block.nonce != null ? block.nonce : '–' %></div>
          </div>
        </div>
      </div>
    </section>

    <section class="card mt-lg">
      <div class="card-header">
        <div class="section-title">Transactions</div>
        <span class="card-subtext">Click a transaction to view full details</span>
      </div>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>TxID</th>
            </tr>
          </thead>
          <tbody>
            <% if (Array.isArray(block.tx)) { %>
              <% block.tx.forEach(function(tx) { %>
                <tr>
                  <td class="hash">
                    <% if (typeof tx === 'string') { %>
                      <a href="/tx/<%= tx %>" class="hash-with-copy">
                        <span class="hash-truncate" title="<%= tx %>"><%= tx %></span>
                      </a>
                    <% } else { %>
                      <a href="/tx/<%= tx.txid %>" class="hash-with-copy">
                        <span class="hash-truncate" title="<%= tx.txid %>"><%= tx.txid %></span>
                      </a>
                    <% } %>
                  </td>
                </tr>
              <% }); %>
            <% } %>
          </tbody>
        </table>
      </div>
    </section>
  </main>
</body>
</html>
